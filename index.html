<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>절대방어 쇼핑</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🛒</text></svg>">
    
    <!-- Google Analytics 동적 로드 (CORB 오류 해결) -->
    <script>
    // Google Analytics 동적 로드 함수
    function loadGoogleAnalytics() {
        console.log('Google Analytics 동적 로드 시작...');
        
    // 환경별 측정 ID 자동 선택
    const isLocalhost = window.location.hostname === 'localhost' || 
                       window.location.hostname === '127.0.0.1';
    
    const measurementId = 'G-BVJPXJP2T9';  // 모든 환경에서 Netlify ID 사용
    
    console.log('현재 환경:', isLocalhost ? '로컬 개발' : '프로덕션');
    console.log('사용할 측정 ID:', measurementId, '(Netlify ID 통일)');
    
    const script = document.createElement('script');
    script.async = true;
    script.src = `https://www.googletagmanager.com/gtag/js?id=${measurementId}`;
        
        script.onload = function() {
            console.log('Google Analytics 스크립트 로드 성공');
            
            // gtag 함수 정의
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            window.gtag = gtag;
            
            gtag('js', new Date());
            gtag('config', measurementId, {
                page_title: '절대방어 쇼핑 - 가격비교 사이트',
                page_location: window.location.href,
                send_page_view: true,
                anonymize_ip: false,
                allow_google_signals: true,
                allow_ad_personalization_signals: false,
                debug_mode: true
            });
            
            console.log('Google Analytics 초기화 완료');
            
            // 즉시 페이지뷰 이벤트 전송
            gtag('event', 'page_view', {
                page_title: '절대방어 쇼핑 - 가격비교 사이트',
                page_location: window.location.href,
                page_path: window.location.pathname
            });
            
            console.log('초기 페이지뷰 이벤트 전송 완료');
        };
        
        script.onerror = function() {
            console.error('Google Analytics 스크립트 로드 실패 - CORB 차단됨');
            console.log('대체 추적 방법을 사용합니다...');
            
            // 대체 추적 방법 (Measurement Protocol)
            initFallbackTracking();
        };
        
        document.head.appendChild(script);
    }
    
    // 로컬 스토리지 기반 추적 시스템
    function initFallbackTracking() {
        console.log('로컬 스토리지 추적 시스템 초기화...');
        
        // 클라이언트 ID 생성
        function generateClientId() {
            let clientId = localStorage.getItem('ga_client_id');
            if (!clientId) {
                clientId = Math.random().toString(36).substring(2) + Date.now().toString(36);
                localStorage.setItem('ga_client_id', clientId);
            }
            return clientId;
        }
        
        // 로컬 스토리지에 이벤트 저장
        function saveEventToLocal(eventName, parameters) {
            try {
                const events = JSON.parse(localStorage.getItem('ga_events') || '[]');
                const event = {
                    client_id: generateClientId(),
                    event_name: eventName,
                    parameters: parameters,
                    timestamp: new Date().toISOString(),
                    page_title: parameters.page_title || document.title,
                    page_location: parameters.page_location || window.location.href,
                    user_agent: navigator.userAgent,
                    screen_resolution: `${screen.width}x${screen.height}`,
                    language: navigator.language
                };
                
                events.push(event);
                // 최근 100개 이벤트만 유지
                localStorage.setItem('ga_events', JSON.stringify(events.slice(-100)));
                
                console.log('로컬 이벤트 저장 완료:', eventName, parameters);
                
                // 저장된 이벤트 개수 표시
                console.log(`총 저장된 이벤트: ${events.length}개`);
                
                // 이벤트 내보내기 기능 제공
                if (events.length >= 10) {
                    console.log('이벤트 내보내기 가능: localStorage.getItem("ga_events")');
                }
                
            } catch (error) {
                console.error('로컬 이벤트 저장 실패:', error);
            }
        }
        
        // gtag 함수 구현 (로컬 저장)
        window.gtag = function(command, targetId, parameters) {
            if (command === 'event') {
                const eventName = parameters.event_name || parameters.event_category || 'custom_event';
                saveEventToLocal(eventName, parameters);
            } else if (command === 'config') {
                console.log('GA 설정 저장:', targetId, parameters);
                localStorage.setItem('ga_config', JSON.stringify({
                    measurement_id: targetId,
                    config: parameters,
                    timestamp: new Date().toISOString()
                }));
            }
        };
        
        // 페이지뷰 이벤트 즉시 저장
        saveEventToLocal('page_view', {
            page_title: '절대방어 쇼핑 - 가격비교 사이트',
            page_location: window.location.href,
            page_path: window.location.pathname
        });
        
        console.log('로컬 추적 시스템 활성화됨');
        console.log('저장된 이벤트 확인: localStorage.getItem("ga_events")');
    }
    
    // 페이지 로드 후 Google Analytics 로드
    document.addEventListener('DOMContentLoaded', function() {
        // 약간의 지연 후 로드 (다른 스크립트들이 먼저 로드되도록)
        setTimeout(loadGoogleAnalytics, 100);
    });
    </script>
    
    <link rel="stylesheet" href="style.css">
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, getDoc, onSnapshot, orderBy, query, doc, updateDoc, where, setDoc, deleteDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getStorage, ref, uploadBytes, getDownloadURL, deleteObject } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';
        import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        
        // Firebase 설정 (실제 프로젝트 설정으로 변경하세요)
        // 1. Firebase Console (https://console.firebase.google.com)에서 프로젝트 생성
        // 2. Firestore Database 활성화
        // 3. 프로젝트 설정 > 일반 > 웹 앱에서 설정 복사
const firebaseConfig = {
  apiKey: "AIzaSyB5TXbGISJDljezHHLX93azkB-uixFqQ80",
  authDomain: "price-match-1f952.firebaseapp.com",
  projectId: "price-match-1f952",
  storageBucket: "price-match-1f952.firebasestorage.app",
  messagingSenderId: "630121276155",
  appId: "1:630121276155:web:78337c6ec3270a1457465e",
  measurementId: "G-9V3NBTSTCG"
};
        
        // Firebase 초기화
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const storage = getStorage(app);
        const auth = getAuth(app);
        
        // 익명 인증 시도 (선택적 - Storage 보안 규칙이 "allow write: if request.auth != null;"인 경우에만 필요)
        // 주의: 익명 인증이 실패해도 이미지 업로드는 Storage 보안 규칙이 "allow write: if true;"면 작동합니다.
        // 추천: Firebase Console > Storage > Rules에서 "allow write: if true;"로 설정하는 것이 더 간단합니다.
        signInAnonymously(auth)
            .then(() => {
                console.log('✅ Firebase 익명 인증 성공');
                window.firebaseAuthReady = true;
            })
            .catch((error) => {
                // 익명 인증 실패는 정상일 수 있음 (Storage 보안 규칙이 "allow write: if true;"인 경우)
                // 에러 로그 최소화 - 조용히 처리
                window.firebaseAuthReady = false;
                window.firebaseAuthError = error;
            });
        
        // 인증 상태 확인
        onAuthStateChanged(auth, (user) => {
            if (user) {
                console.log('Firebase 인증 상태: 로그인됨 (익명)', user.uid);
            } else {
                console.log('Firebase 인증 상태: 로그아웃됨');
            }
        });
        
        // 전역 변수로 설정
        window.firebaseApp = app;
        window.firestoreDB = db;
        window.firebaseDb = db; // 호환성을 위한 별칭
        window.firebaseStorage = () => storage;
        window.firebaseStorageRef = ref;
        window.firebaseUploadBytes = uploadBytes;
        window.firebaseGetDownloadURL = getDownloadURL;
        window.firebaseDeleteObject = deleteObject;
        window.firebaseCollection = collection;
        window.firebaseAddDoc = addDoc;
        window.firebaseGetDocs = getDocs;
        window.firebaseGetDoc = getDoc;
        window.firebaseOnSnapshot = onSnapshot;
        window.firebaseOrderBy = orderBy;
        window.firebaseQuery = query;
        window.firebaseDoc = doc;
        window.firebaseUpdateDoc = updateDoc;
        window.firebaseWhere = where;
        window.firebaseSetDoc = setDoc;
        window.firebaseDeleteDoc = deleteDoc;
        window.firebaseAuth = auth;
        window.firebaseServerTimestamp = serverTimestamp;
    </script>
</head>
<body>
    <!-- 모바일용 최상단 버튼 바 (최저가신고, 필독, 관리만) -->
    <div class="top-button-bar mobile-only">
        <button class="header-btn mini-btn" onclick="toggleSection('productFormDropdown')">
            📝 핫딜 신고
        </button>
        <button class="header-btn" onclick="toggleSection('noticePanel')">
            📢 필독
        </button>
        <button class="header-btn" id="adminBtn" onclick="toggleSection('adminPanel')">
            ⚙️ 관리
            <span id="adminNotification" class="admin-notification hidden">•</span>
        </button>
    </div>

    <div class="container">
        <!-- 헤더 -->
        <header class="header">
            <div class="header-left">
                <!-- 빈 공간 -->
            </div>

            <div class="header-center">
                <h1 class="logo" onclick="goToHome()" style="cursor: pointer;">
                    절대방어 쇼핑
                    <span class="visitor-counter-badge" id="dailyVisitorBadge">
                        <span class="visitor-line-1">
                            <span class="visitor-text">오늘</span>
                            <span id="dailyVisitors" class="visitor-count">0</span>
                            <span class="visitor-text">명</span>
                        </span>
                        <span class="visitor-line-2">
                            <span class="visitor-text">방문</span>
                        </span>
                    </span>
                </h1>
            </div>

            <div class="header-right">
                <!-- PC용 버튼들 (최저가신고, 필독, 관리) - 오른쪽 끝에 배치 -->
                <div class="pc-button-group">
                    <button class="header-btn mini-btn" onclick="toggleSection('productFormDropdown')">
                        📝 핫딜 신고
                    </button>
                    <button class="header-btn" onclick="toggleSection('noticePanel')">
                        📢 필독
                    </button>
                    <button class="header-btn" id="adminBtn" onclick="toggleSection('adminPanel')">
                        ⚙️ 관리
                        <span id="adminNotification" class="admin-notification hidden">•</span>
                    </button>
                </div>
                <div id="productFormDropdown" class="header-dropdown collapsed">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="margin: 0; font-size: 1.1rem; font-weight: 600;">핫딜 신고</h3>
                        <button onclick="showMyPriceReports()" style="padding: 6px 12px; font-size: 0.85rem; background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            ✏️ 핫딜 신고 수정
                        </button>
                    </div>
                    <form id="productForm" class="product-form">
                        <div class="form-group">
                            <label for="productName">제품명</label>
                            <input type="text" id="productName" name="productName" placeholder="제품명을 입력하세요">
                        </div>
                        
                        <div class="form-group">
                            <label for="productOriginalPrice" style="color: #60a5fa;">정가(시작가)</label>
                            <input type="number" id="productOriginalPrice" name="productOriginalPrice" placeholder="정가(시작가)를 입력하세요 (원)">
                        </div>
                        
                        <div class="form-group">
                            <label for="productPrice" style="color: #dc2626;">최종가</label>
                            <input type="number" id="productPrice" name="productPrice" placeholder="최종가를 입력하세요 (원)">
                        </div>
                        
                        <div class="form-group">
                            <label for="productLink">링크</label>
                            <input type="url" id="productLink" name="productLink" placeholder="https://example.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="productStore">쇼핑몰</label>
                            <select id="productStore" name="productStore">
                                <option value="">미선택</option>
                                <option value="쿠팡">쿠팡</option>
                                <option value="네이버">네이버</option>
                                <option value="11번가">11번가</option>
                                <option value="G마켓">G마켓</option>
                                <option value="옥션">옥션</option>
                                <option value="롯데온">롯데온</option>
                                <option value="기타">기타</option>
                            </select>
                        </div>
                        
                        <!-- 카테고리 선택 (선택사항) -->
                        <div class="category-selector">
                            <label for="productCategory">카테고리 (선택사항)</label>
                            <select id="productCategory" name="productCategory">
                                <option value="">카테고리 선택 안함</option>
                                <option value="식품">식품</option>
                                <option value="의류">의류</option>
                                <option value="생활">생활</option>
                                <option value="가전">가전</option>
                                <option value="ETC">ETC</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="productImage">상품 이미지 (선택사항, 여러장 가능)</label>
                            <input type="file" id="productImage" name="productImage" accept="image/*" multiple onchange="handleImageSelection()">
                            <small style="color: #6b7280; font-size: 0.8rem;">JPG, PNG 형식, 자동 압축 (최대 1MB, 권장 500KB 이하) (Ctrl/Cmd 키로 여러장 선택)</small>
                            <div id="imagePreviewContainer" style="display: none; margin-top: 12px;"></div>
                        </div>
                        
                        <div class="form-group">
                            <label for="productDescription">게시글 작성 (선택사항)</label>
                            <textarea id="productDescription" name="productDescription" rows="8" placeholder="상품에 대한 상세 설명이나 후기를 작성해주세요... (인터넷 주소를 입력하면 클릭 가능한 링크로 변환됩니다)"></textarea>
                        </div>
                        
                        <button type="submit" class="submit-btn">제품 등록</button>
                    </form>
                    
                    <!-- 감사 메시지 -->
                    <div id="thankYouMessage" class="thank-you-message hidden">
                        <div class="message-content">
                            <h4 id="messageTitle">🎉 감사합니다!</h4>
                            <p id="messageText">제품 정보가 성공적으로 등록되었습니다.</p>
                            <button id="closeMessage" class="close-btn">확인</button>
                        </div>
                    </div>
                </div>
                
                <!-- 필독 패널 -->
                <div id="noticePanel" class="notice-panel collapsed">
                    <!-- 공지사항 섹션 -->
                    <div class="notice-section">
                        <div class="notice-header">
                            <h4>📢 공지사항</h4>
                            <div class="notice-controls">
                                <button id="editNotice" class="notice-btn edit-btn hidden">✏️ 수정</button>
                                <button id="addNotice" class="notice-btn add-btn hidden">➕ 추가</button>
                                <button id="deleteNotice" class="notice-btn delete-btn hidden">🗑️ 삭제</button>
                            </div>
                        </div>
                        
                        <!-- 공지사항 표시 -->
                        <div id="noticeDisplay" class="notice-display">
                            <div class="main-notice">
                                <h5>대문글</h5>
                                <div id="mainNoticeContent" class="notice-content-item">대문글이 없습니다.</div>
                            </div>
                            <div class="sub-notices">
                                <div class="notice-item">
                                    <span class="notice-label">공지1:</span>
                                    <span id="notice1Content" class="notice-content-item">공지1이 없습니다.</span>
                                </div>
                                <div class="notice-item">
                                    <span class="notice-label">공지2:</span>
                                    <span id="notice2Content" class="notice-content-item">공지2가 없습니다.</span>
                                </div>
                                <div class="notice-item">
                                    <span class="notice-label">공지3:</span>
                                    <span id="notice3Content" class="notice-content-item">공지3이 없습니다.</span>
                                </div>
                                <div class="notice-item">
                                    <span class="notice-label">공지4:</span>
                                    <span id="notice4Content" class="notice-content-item">공지4가 없습니다.</span>
                                </div>
                                <div class="notice-item">
                                    <span class="notice-label">공지5:</span>
                                    <span id="notice5Content" class="notice-content-item">공지5가 없습니다.</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 공지사항 편집 -->
                        <div id="noticeEdit" class="notice-edit hidden">
                            <div class="notice-edit-form">
                                <div class="form-group">
                                    <label for="mainNoticeTextarea">대문글</label>
                                    <textarea id="mainNoticeTextarea" rows="4" placeholder="대문글을 입력하세요..."></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label for="notice1Textarea">공지1</label>
                                    <textarea id="notice1Textarea" rows="1" placeholder="공지1을 입력하세요..."></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label for="notice2Textarea">공지2</label>
                                    <textarea id="notice2Textarea" rows="1" placeholder="공지2를 입력하세요..."></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label for="notice3Textarea">공지3</label>
                                    <textarea id="notice3Textarea" rows="1" placeholder="공지3을 입력하세요..."></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label for="notice4Textarea">공지4</label>
                                    <textarea id="notice4Textarea" rows="1" placeholder="공지4를 입력하세요..."></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label for="notice5Textarea">공지5</label>
                                    <textarea id="notice5Textarea" rows="1" placeholder="공지5를 입력하세요..."></textarea>
                                </div>
                                
                                <div class="notice-actions">
                                    <button id="saveNotice" class="notice-btn save-btn">저장</button>
                                    <button id="cancelNotice" class="notice-btn cancel-btn">취소</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 숫자별 댓글 섹션 -->
                    <div class="comments-section">
                        <div class="comments-header">
                            <h4>💬 댓글</h4>
                            <span id="commentCount" class="comment-count">0개</span>
                        </div>
                        
                        <!-- 숫자별 댓글 목록 -->
                        <div id="commentsList" class="comments-list">
                            <!-- 숫자별 댓글들이 여기에 동적으로 추가됩니다 -->
                        </div>
                    </div>
                </div>
                
                <!-- 공지사항 상세보기 모달 -->
                <div id="noticeDetailModal" class="modal hidden">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="noticeDetailTitle">공지사항 상세보기</h3>
                            <button id="closeNoticeDetail" class="close-btn">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div id="noticeDetailContent" class="notice-detail-content">
                                <!-- 공지사항 내용이 여기에 표시됩니다 -->
                            </div>
                            
                            <!-- 공지사항별 댓글 섹션 -->
                            <div class="notice-comments-section">
                                <div class="comments-header">
                                    <h4>💬 댓글</h4>
                                    <span id="noticeCommentCount" class="comment-count">0개</span>
                                </div>
                                
                                <!-- 댓글 작성 -->
                                <div class="notice-comment-form">
                                    <div class="form-group">
                                        <label for="noticeCommentInput">댓글 작성</label>
                                        <textarea id="noticeCommentInput" rows="3" placeholder="댓글을 작성하세요..."></textarea>
                                    </div>
                                    
                                    <button id="submitNoticeComment" class="comment-btn submit-btn">댓글 작성</button>
                                </div>
                                
                                <!-- 댓글 목록 -->
                                <div id="noticeCommentsList" class="comments-list">
                                    <!-- 댓글들이 여기에 동적으로 추가됩니다 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="adminPanel" class="header-dropdown collapsed" style="display: none !important;">
                    <div class="admin-panel">
                        <div class="admin-controls">
                            <button id="loadPendingProducts" class="admin-btn">
                                승인대기
                                <span id="pendingProductsBadge" class="admin-badge hidden">0</span>
                            </button>
                            <button id="loadAllProducts" class="admin-btn">전체</button>
                            <button id="loadPriceReports" class="admin-btn">
                                변경신고
                                <span id="priceReportsBadge" class="admin-badge hidden">0</span>
                            </button>
                            <button id="loadOutOfStockSettings" class="admin-btn">숨김</button>
                            <button id="adminLogout" class="admin-btn logout-btn">🚪 로그아웃</button>
                        </div>
                        
                        <!-- 숨김 상품 관리 패널 (기존 품절설정 영역 재사용) -->
                        <div id="outOfStockSettings" class="pending-products-list" style="display: none;">
                            <div class="settings-section">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                    <h3 style="margin: 0;">숨김 상품 관리</h3>
                                </div>
                                <p style="font-size: 0.85rem; color: #6b7280; margin-bottom: 12px;">
                                    숨김 처리된 상품들을 여기에서 수정, 복원, 완전 삭제, 링크 연결할 수 있습니다.
                                </p>
                                <button id="deleteAllImages" class="admin-btn" style="background-color: #dc2626; color: white; width: 100%; margin-bottom: 16px; font-weight: 600; padding: 12px;">🗑️ 이미지 일괄 삭제</button>
                                <div id="hiddenProductsList" class="pending-products-list"></div>
                            </div>
                        </div>
                        <div id="pendingProductsList" class="pending-products-list"></div>
                        <div id="allProductsList" class="pending-products-list"></div>
                        <div id="priceReportsList" class="pending-products-list"></div>
                    </div>
                </div>
            </div>
        </header>

        <!-- 카테고리 바 -->
        <div class="category-bar">
            <div class="category-item" onclick="filterByCategory('전체')">
                <span class="category-name">전체</span>
                <span class="category-count" id="totalCount">0</span>
            </div>
            <div class="category-item" data-category="식품" onclick="filterByCategory('식품')">
                <span class="category-name"><span style="font-size: 0.7em; vertical-align: middle;">🍚</span> 식품</span>
                <span class="category-count" id="foodCount">0</span>
            </div>
            <div class="category-item" data-category="의류" onclick="filterByCategory('의류')">
                <span class="category-name"><span style="font-size: 0.7em; vertical-align: middle;">👕</span> 의류</span>
                <span class="category-count" id="clothesCount">0</span>
            </div>
            <div class="category-item" data-category="생활" onclick="filterByCategory('생활')">
                <span class="category-name"><span style="font-size: 0.7em; vertical-align: middle;">🏠</span> 생활</span>
                <span class="category-count" id="dailyCount">0</span>
            </div>
            <div class="category-item" data-category="가전" onclick="filterByCategory('가전')">
                <span class="category-name"><span style="font-size: 0.7em; vertical-align: middle;">🌀</span> 가전</span>
                <span class="category-count" id="electronicsCount">0</span>
            </div>
            <div class="category-item category-item-etc" data-category="ETC" onclick="filterByCategory('ETC')">
                <span class="category-name"><span style="font-size: 0.7em; vertical-align: middle;">🎸</span> ETC</span>
                <span class="category-count" id="etcCount">0</span>
            </div>
        </div>

        <!-- PC용 검색바 (카테고리바와 정렬바 사이) -->
        <div class="search-bar-between mobile-hidden">
            <div class="search-bar-container">
                <input type="text" id="searchInputPC" class="search-input" placeholder="검색어를 쓰세요" onkeypress="handleSearchKeyPress(event)" oninput="syncSearchInputs(event)">
                <button class="search-btn" onclick="performSearch()">🔍</button>
            </div>
        </div>

        <!-- 정렬 바 -->
        <div class="sort-bar">
            <div class="sort-buttons">
                <button class="sort-item" data-sort="discount" onclick="sortProducts('discount')">
                    할인율
                </button>
                <button class="sort-item" data-sort="newest" onclick="sortProducts('newest')">
                    신규순
                </button>
                <button class="sort-item" data-sort="price-low" onclick="sortProducts('price-low')">
                    저가순
                </button>
                <button class="sort-item" data-sort="price-high" onclick="sortProducts('price-high')">
                    고가순
                </button>
                <button class="sort-item" data-sort="clicks" onclick="sortProducts('clicks')">
                    클릭순
                </button>
                <button class="sort-item active" data-sort="purchases" onclick="sortProducts('purchases')">
                    구매순
                </button>
                <button class="sort-item" data-sort="revenue" onclick="sortProducts('revenue')">
                    매출순
                </button>
            </div>
            <!-- 모바일용 검색바 (정렬바 우측) -->
            <div class="search-bar-container mobile-only">
                <input type="text" id="searchInput" class="search-input" placeholder="검색어를 쓰세요" onkeypress="handleSearchKeyPress(event)" oninput="syncSearchInputs(event)">
                <button class="search-btn" onclick="performSearch()">🔍</button>
            </div>
        </div>

        <!-- 검색 결과 -->
        <main class="main-content">
            <div id="loading" class="loading hidden">
                <div class="spinner"></div>
                <p>가격을 비교하고 있습니다...</p>
            </div>

            <div id="searchResults" class="search-results hidden">
                <div id="productList" class="product-list"></div>
            </div>

            <div id="noResults" class="no-results hidden">
                <p>검색 결과가 없습니다. 다른 키워드로 검색해보세요.</p>
            </div>
        </main>
    </div>

    <!-- 상품 상세보기 모달 -->
    <div id="productDetailDropdown" class="header-dropdown collapsed">
        <div class="product-detail-content">
            <!-- 본문 -->
            <div class="product-detail-body">
                <div id="productDetailInfo" class="detail-info">
                    <!-- 상품 정보가 여기에 표시됩니다 -->
                </div>
                
                <div id="productDetailPosts" class="posts-section">
                    <!-- 게시글들이 여기에 표시됩니다 -->
                </div>
                
                <div id="commentActionsSection" class="comment-actions-section" style="display: none;">
                    <div class="detail-actions">
                        <button onclick="handleRecommendClick()" id="recommendBtn" class="detail-action-btn recommend-btn">
                            추천 <span id="recommendCount">0</span>
                        </button>
                        <button onclick="handleOutOfStockClick()" id="outOfStockDetailBtn" class="detail-action-btn out-of-stock-btn">
                            품절 <span id="outOfStockCount">0</span>
                        </button>
                        <a id="purchaseDetailBtn" href="#" target="_blank" class="detail-action-btn purchase-btn">구매하기</a>
                    </div>
                </div>
                
                <div id="commentFormSection" class="comment-form-section" style="margin-top: 20px;">
                    <textarea id="productDetailComment" rows="3" placeholder="댓글을 작성하세요..."></textarea>
                    <button onclick="submitProductDetailComment()">댓글 작성</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 삭제 확인 팝업 -->
    <div id="deleteConfirmationPopup" class="delete-confirmation-overlay">
        <div class="delete-confirmation-popup">
            <div class="delete-confirmation-header">
                <h3>⚠️ 삭제 확인</h3>
            </div>
            <div class="delete-confirmation-content">
                <p id="deleteConfirmationMessage">정말로 삭제하시겠습니까?</p>
                <p class="delete-warning">이 작업은 되돌릴 수 없습니다.</p>
            </div>
            <div class="delete-confirmation-actions">
                <button id="deleteConfirmYes" class="delete-yes-btn">YES</button>
                <button id="deleteConfirmNo" class="delete-no-btn">NO</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
